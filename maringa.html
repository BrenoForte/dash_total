<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Gestão à vista — Maringá / Setembro</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

<style>
  /* ===== Sem CSS variables / clamp; compatível com browsers antigos ===== */
  * { box-sizing:border-box; }
  html, body { height:100%; }
  body {
    margin:0; background:#ffffff; color:#0b1220;
    font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial, sans-serif;
    overflow:hidden;
  }
  header{
    height:12vh; min-height:80px; max-height:140px;
    display:-ms-flexbox; display:flex;
    -ms-flex-align:center; align-items:center;
    -ms-flex-pack:justify; justify-content:space-between;
    padding:1.2vh 2vw; border-bottom:1px solid #e5e7eb;
  }
  .title-wrap{ display:-ms-flexbox; display:flex; -ms-flex-align:center; align-items:center; }
  .logo-img{ height:72px; width:128px; object-fit:cover; border-radius:12px; border:1px solid #e5e7eb; }
  h1{ margin:0 0 6px 16px; font-weight:800; font-size:28px; }
  .badge{ display:inline-block; margin-left:16px; font-size:16px; background:#f1f5f9; border:1px solid #e2e8f0; padding:.4em .8em; border-radius:999px; color:#0f172a; }

  /* ===== Layout principal sem Grid (Flex responsivo) ===== */
  .slide{
    height:88vh;
    padding:1.6vh 2vw;
    display:-ms-flexbox; display:flex;
    -ms-flex-wrap:wrap; flex-wrap:wrap;
    -ms-flex-direction:row; flex-direction:row;
  }
  .card{
    background:#ffffff; border:1px solid #e5e7eb; border-radius:16px;
    padding:1.2vh 1.2vw;
    display:-ms-flexbox; display:flex; -ms-flex-direction:column; flex-direction:column;
    width:calc(50% - 2vw);  /* duas colunas */
    margin:0 1vw 1.6vh 0;   /* espaçamento (substitui gap) */
  }
  .card:nth-child(2n){ margin-right:0; } /* fecha linha a cada 2 cards */
  .card h3{ margin:0 0 .6vh 0; font-size:22px; color:#0f172a; }

  .chart-row{
    display:-ms-flexbox; display:flex;
    -ms-flex-pack:justify; justify-content:space-between;
    -ms-flex-align:center; align-items:center;
    -ms-flex:1 1 auto; flex:1 1 auto;
    min-height:0;
  }
  .chart-box{
    position:relative;
    -ms-flex:0 0 58%; flex:0 0 58%;
    display:-ms-flexbox; display:flex; -ms-flex-align:center; align-items:center; -ms-flex-pack:center; justify-content:center;
    min-width:0; min-height:0;
  }
  .side-values{
    -ms-flex:1 1 40%; flex:1 1 40%;
    display:-ms-flexbox; display:flex; -ms-flex-direction:column; flex-direction:column;
    margin-left:1.2vw;
  }
  .sv-item{
    display:-ms-flexbox; display:flex; -ms-flex-pack:justify; justify-content:space-between; -ms-flex-align:center; align-items:center;
    border:1px solid #e5e7eb; border-radius:12px; padding:.6vh .8vw; font-size:18px; margin-bottom:.6vh;
  }
  .sv-left{ display:-ms-flexbox; display:flex; -ms-flex-align:center; align-items:center; color:#334155; }
  .dot{ width:14px; height:14px; border-radius:50%; display:inline-block; margin-right:.6vw; }
  .sv-value{ font-weight:800; color:#0b1220; }
  canvas{ max-width:100%; max-height:100%; }
  .fs-btn{ position:fixed; right:1.2vw; bottom:1.2vh; background:#0f172a; color:#fff; border:none; padding:.8em 1em; border-radius:10px; cursor:pointer; font-weight:700; }

  /* ===== Responsivo simples ===== */
  @media (max-width:900px){
    .card{ width:100%; margin-right:0; }
    h1{ font-size:24px; }
  }
</style>
</head>
<body>
  <header>
    <div class="title-wrap">
      <video class="logo-img" autoplay muted loop playsinline>
        <source src="C:/Users/breno.luna/Documents/VIDEOS.mp4" type="video/mp4">
        Seu navegador não suporta vídeo.
      </video>
      <div>
        <h1>Gestão à vista — Maringá / Setembro</h1>
        <div class="badge" id="badgeInfo"></div>
      </div>
    </div>
  </header>

  <section class="slide">
    <div class="card">
      <h3>Distribuição por dia da semana</h3>
      <div class="chart-row">
        <div class="chart-box"><canvas id="pieDiaSemana"></canvas></div>
        <div class="side-values" id="sideDiaSemana"></div>
      </div>
    </div>
    <div class="card">
      <h3>Peso por semana do mês</h3>
      <div class="chart-row">
        <div class="chart-box"><canvas id="pieSemanas"></canvas></div>
        <div class="side-values" id="sideSemanas"></div>
      </div>
    </div>
    <div class="card">
      <h3>Inservíveis do mês</h3>
      <div class="chart-row">
        <div class="chart-box"><canvas id="piePlacas"></canvas></div>
        <div class="side-values" id="sidePlacas"></div>
      </div>
    </div>
    <div class="card">
      <h3>Setores abrangidos (meta 100%)</h3>
      <div class="chart-row">
        <div class="chart-box"><canvas id="pieSetores"></canvas></div>
        <div class="side-values" id="sideSetores"></div>
      </div>
    </div>
  </section>

  <button class="fs-btn" id="fsBtn">Tela cheia</button>

  <!-- Chart.js compatível com browsers antigos -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0"></script>

  <script>
  // ===== Dados preservados do arquivo original =====
  var PIE = {"dia_semana_labels": ["Seg", "Ter", "Qua", "Qui", "Sex", "Sáb", "Dom"], "dia_semana_values": [111680.0, 123720.0, 127360.0, 114700.0, 115980.0, 109390.0, 0.0], "semanas_mes_labels": ["Semana 1", "Semana 2", "Semana 3", "Semana 4"], "semanas_mes_values": [181610.0, 175060.0, 172490.0, 173670.0], "placas_labels": ["Inservíveis"], "placas_values": [161180.0], "setores_labels": ["Abrangidos", "Não abrangidos"], "setores_values": [100, 0]};
  var RES = {"peso_total": 702830.0, "media_semana": 175707.5, "atualizado_em": "01/10/2025 08:02"};
  var COLORS = ['#2563eb','#16a34a','#f59e0b','#ef4444','#a855f7','#06b6d4','#7c3aed','#10b981'];

  function thousands(v){
    v = Math.round(+v || 0) + '';
    return v.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
  }

  (function(){
    var badge = document.getElementById('badgeInfo');
    if (badge){
      badge.innerHTML = 'Peso total: ' + thousands(RES.peso_total) + ' kg • Média por semana: ' + thousands(Math.round(RES.media_semana)) + ' kg • Atualizado ' + RES.atualizado_em;
    }
  })();

  function makePie(ctx, labels, values){
    var total = 0, i;
    for(i=0;i<values.length;i++){ total += (+values[i] || 0); }
    if (!total) total = 1;

    var colors = [];
    for(i=0;i<labels.length;i++){ colors.push(COLORS[i % COLORS.length]); }

    return new Chart(ctx, {
      type: 'doughnut',
      data: { labels: labels, datasets: [{ data: values, backgroundColor: colors, borderWidth: 1 }] },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        legend: { display: false },
        cutoutPercentage: 55,
        tooltips: {
          callbacks: {
            label: function(tooltipItem, data){
              var idx = tooltipItem.index;
              var val = (+values[idx] || 0);
              var pct = ((val/total)*100).toFixed(1);
              var label = data.labels[idx] || '';
              return ' ' + label + ': ' + thousands(val) + ' (' + pct + '%)';
            }
          }
        },
        plugins: {
          datalabels: {
            color: '#0b1220',
            formatter: function(value, ctx2){
              var t = 0, j, arr = ctx2.chart.data.datasets[0].data;
              for(j=0;j<arr.length;j++){ t += (+arr[j] || 0); }
              if (!t) t = 1;
              return ((value/t)*100).toFixed(0) + '%';
            },
            font: { weight:'800', size: 16 }
          }
        }
      }
    });
  }

  // Dia da semana
  (function(){
    var labels = PIE.dia_semana_labels;
    var values = PIE.dia_semana_values;
    var ctx = document.getElementById('pieDiaSemana').getContext('2d');
    makePie(ctx, labels, values);

    var total = 0, i; for(i=0;i<values.length;i++){ total += (+values[i]||0); } if(!total) total=1;
    var cont = document.getElementById('sideDiaSemana');
    if (cont){
      var html = '';
      for(i=0;i<labels.length;i++){
        var v = (+values[i]||0), pct=((v/total)*100).toFixed(1);
        html += '<div class="sv-item"><div class="sv-left"><span class="dot" style="background:'+COLORS[i % COLORS.length]+'"></span>'+labels[i]+'</div><div class="sv-value">'+thousands(v)+' kg ('+pct+'%)</div></div>';
      }
      cont.innerHTML = html;
    }
  })();

  // Semanas
  (function(){
    var labels = PIE.semanas_mes_labels;
    var values = PIE.semanas_mes_values;
    var ctx = document.getElementById('pieSemanas').getContext('2d');
    makePie(ctx, labels, values);

    var total = 0, i; for(i=0;i<values.length;i++){ total += (+values[i]||0); } if(!total) total=1;
    var cont = document.getElementById('sideSemanas');
    if (cont){
      var html = '';
      for(i=0;i<labels.length;i++){
        var v = (+values[i]||0), pct=((v/total)*100).toFixed(1);
        html += '<div class="sv-item"><div class="sv-left"><span class="dot" style="background:'+COLORS[i % COLORS.length]+'"></span>'+labels[i]+'</div><div class="sv-value">'+thousands(v)+' kg ('+pct+'%)</div></div>';
      }
      cont.innerHTML = html;
    }
  })();

  // Inservíveis do mês
  (function(){
    var labels = PIE.placas_labels;
    var values = PIE.placas_values;
    var ctx = document.getElementById('piePlacas').getContext('2d');
    makePie(ctx, labels, values);

    var total = 0, i; for(i=0;i<values.length;i++){ total += (+values[i]||0); } if(!total) total=1;
    var cont = document.getElementById('sidePlacas');
    if (cont){
      var html = '';
      for(i=0;i<labels.length;i++){
        var v = (+values[i]||0), pct=((v/total)*100).toFixed(1);
        html += '<div class="sv-item"><div class="sv-left"><span class="dot" style="background:'+COLORS[i % COLORS.length]+'"></span>'+labels[i]+'</div><div class="sv-value">'+thousands(v)+' kg ('+pct+'%)</div></div>';
      }
      cont.innerHTML = html;
    }
  })();

  // Setores abrangidos
  (function(){
    var labels = PIE.setores_labels;
    var values = PIE.setores_values;
    var ctx = document.getElementById('pieSetores').getContext('2d');
    makePie(ctx, labels, values);

    var total = 0, i; for(i=0;i<values.length;i++){ total += (+values[i]||0); } if(!total) total=1;
    var cont = document.getElementById('sideSetores');
    if (cont){
      var html = '';
      for(i=0;i<labels.length;i++){
        var v = (+values[i]||0), pct=((v/total)*100).toFixed(1);
        html += '<div class="sv-item"><div class="sv-left"><span class="dot" style="background:'+COLORS[i % COLORS.length]+'"></span>'+labels[i]+'</div><div class="sv-value">'+thousands(v)+' ('+pct+'%)</div></div>';
      }
      cont.innerHTML = html;
    }
  })();

  // Botão de tela cheia (com fallbacks)
  (function(){
    var fsBtn = document.getElementById('fsBtn');
    if (!fsBtn) return;
    fsBtn.onclick = function(){
      var el = document.documentElement;
      if (el.requestFullscreen) el.requestFullscreen();
      else if (el.msRequestFullscreen) el.msRequestFullscreen();
      else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
    };
  })();

  // ===== Redireciona automaticamente para index.html após 7 segundos =====
  setTimeout(function(){
    window.location.replace("index.html");
  }, 7000);
  </script>
</body>
</html>
