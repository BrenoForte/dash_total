<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Gestão à vista — Maringá / Setembro</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root { --bg:#ffffff; --card:#ffffff; --muted:#475569; --text:#0b1220; --line:#e5e7eb; }
  * { box-sizing:border-box; } html, body { height:100%; }
  body { margin:0; background:var(--bg); color:var(--text); font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; overflow:hidden; }
  header { height:12vh; min-height:80px; max-height:140px; display:flex; align-items:center; justify-content:space-between; gap:24px; padding:1.2vh 2vw; border-bottom:1px solid var(--line); }
  .title-wrap { display:flex; align-items:center; gap:16px; }
  .logo-img { height:72px; width:128px; object-fit:cover; border-radius:12px; border:1px solid #e5e7eb; }
  h1 { margin:0; font-weight:800; font-size: clamp(20px, 3.2vh, 42px); }
  .badge { font-size: clamp(12px, 2vh, 18px); background:#f1f5f9; border:1px solid #e2e8f0; padding:.6em 1em; border-radius:999px; color:#0f172a; }
  .slide { height:88vh; display:grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap:1.6vh; padding:1.6vh 2vw; }
  .card { background:var(--card); border:1px solid var(--line); border-radius:16px; padding:1.2vh 1.2vw; display:flex; flex-direction:column; }
  .card h3 { margin:0 0 .6vh 0; font-size: clamp(16px, 2.4vh, 28px); color:#0f172a; }
  .chart-row { display:flex; gap:1.2vw; align-items:center; justify-content:space-between; flex:1; min-height:0; }
  .chart-box { position:relative; flex: 1 1 60%; display:flex; align-items:center; justify-content:center; min-width:0; min-height:0; }
  .side-values { flex: 1 1 40%; display:flex; flex-direction:column; gap:.6vh; }
  .sv-item { display:flex; align-items:center; justify-content:space-between; border:1px solid var(--line); border-radius:12px; padding:.6vh .8vw; font-size: clamp(14px, 2.2vh, 22px); }
  .sv-left { display:flex; align-items:center; gap:.6vw; color:#334155; }
  .dot { width:14px; height:14px; border-radius:50%; display:inline-block; }
  .sv-value { font-weight:800; color:#0b1220; }
  canvas { max-width:100%; max-height:100%; }
  .fs-btn { position:fixed; right:1.2vw; bottom:1.2vh; background:#0f172a; color:#fff; border:none; padding:.8em 1em; border-radius:10px; cursor:pointer; font-weight:700; }
</style>
</head>
<body>
  <header>
    <div class="title-wrap">
      <video class="logo-img" autoplay muted loop playsinline>
        <source src="C:/Users/breno.luna/Documents/VIDEOS.mp4" type="video/mp4">
        Seu navegador não suporta vídeo.
      </video>
      <div>
        <h1>Gestão à vista — Maringá / Setembro</h1>
        <div class="badge" id="badgeInfo"></div>
      </div>
    </div>
  </header>

  <section class="slide">
    <div class="card">
      <h3>Distribuição por dia da semana</h3>
      <div class="chart-row">
        <div class="chart-box"><canvas id="pieDiaSemana"></canvas></div>
        <div class="side-values" id="sideDiaSemana"></div>
      </div>
    </div>
    <div class="card">
      <h3>Peso por semana do mês</h3>
      <div class="chart-row">
        <div class="chart-box"><canvas id="pieSemanas"></canvas></div>
        <div class="side-values" id="sideSemanas"></div>
      </div>
    </div>
    <div class="card">
      <h3>Inservíveis do mês</h3>
      <div class="chart-row">
        <div class="chart-box"><canvas id="piePlacas"></canvas></div>
        <div class="side-values" id="sidePlacas"></div>
      </div>
    </div>
    <div class="card">
      <h3>Setores abrangidos (meta 100%)</h3>
      <div class="chart-row">
        <div class="chart-box"><canvas id="pieSetores"></canvas></div>
        <div class="side-values" id="sideSetores"></div>
      </div>
    </div>
  </section>

  <button class="fs-btn" id="fsBtn">Tela cheia</button>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
<script>
  const PIE = {"dia_semana_labels": ["Seg", "Ter", "Qua", "Qui", "Sex", "Sáb", "Dom"], "dia_semana_values": [111680.0, 123720.0, 127360.0, 114700.0, 115980.0, 109390.0, 0.0], "semanas_mes_labels": ["Semana 1", "Semana 2", "Semana 3", "Semana 4"], "semanas_mes_values": [181610.0, 175060.0, 172490.0, 173670.0], "placas_labels": ["Inservíveis"], "placas_values": [161180.0], "setores_labels": ["Abrangidos", "Não abrangidos"], "setores_values": [100, 0]};
  const RES = {"peso_total": 702830.0, "media_semana": 175707.5, "atualizado_em": "01/10/2025 08:02"};
  const COLORS = ['#2563eb','#16a34a','#f59e0b','#ef4444','#a855f7','#06b6d4','#7c3aed','#10b981'];
  const thousands = (v) => (v||0).toLocaleString('pt-BR');

  document.getElementById('badgeInfo').innerText = 
    "Peso total: " + thousands(RES.peso_total) + " kg • Média por semana: " + thousands(RES.media_semana.toFixed(0)) + " kg • Atualizado " + RES.atualizado_em;

  function makePie(ctx, labels, values) {
    const total = values.reduce((a,b)=>a+(+b||0),0) || 1;
    const colors = labels.map((_,i)=> COLORS[i % COLORS.length]);
    const chart = new Chart(ctx, {
      type: 'doughnut',
      data: { labels, datasets: [{ data: values, backgroundColor: colors, borderWidth: 1 }] },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
          legend: { display: false },
          tooltip: {
            callbacks: {
              label: (c) => " " + c.label + ": " + thousands(c.parsed||0) + " (" + ((c.parsed/total)*100).toFixed(1) + "%)"
            }
          },
          datalabels: { color: '#0b1220', formatter: (v) => ((v/total)*100).toFixed(0) + "%", font: { weight:'800', size: 16 } }
        },
        cutout: '55%'
      },
      plugins: (window.ChartDataLabels ? [ChartDataLabels] : [])
    });
    return {chart, colors, total};
  }

  // Dia da semana
  (function(){
    const labels = PIE.dia_semana_labels;
    const values = PIE.dia_semana_values;
    const ctx = document.getElementById('pieDiaSemana').getContext('2d');
    const {colors, total} = makePie(ctx, labels, values);
    const cont = document.getElementById('sideDiaSemana');
    cont.innerHTML = labels.map((l,i)=>{
      const v = values[i]||0, pct=((v/total)*100).toFixed(1);
      return '<div class="sv-item"><div class="sv-left"><span class="dot" style="background:'+colors[i]+'"></span>'+l+'</div><div class="sv-value">'+thousands(v)+' kg ('+pct+'%)</div></div>';
    }).join('');
  })();

  // Semanas
  (function(){
    const labels = PIE.semanas_mes_labels;
    const values = PIE.semanas_mes_values;
    const ctx = document.getElementById('pieSemanas').getContext('2d');
    const {colors, total} = makePie(ctx, labels, values);
    const cont = document.getElementById('sideSemanas');
    cont.innerHTML = labels.map((l,i)=>{
      const v = values[i]||0, pct=((v/total)*100).toFixed(1);
      return '<div class="sv-item"><div class="sv-left"><span class="dot" style="background:'+colors[i]+'"></span>'+l+'</div><div class="sv-value">'+thousands(v)+' kg ('+pct+'%)</div></div>';
    }).join('');
  })();

  // Placas
  (function(){
    const labels = PIE.placas_labels;
    const values = PIE.placas_values;
    const ctx = document.getElementById('piePlacas').getContext('2d');
    const {colors, total} = makePie(ctx, labels, values);
    const cont = document.getElementById('sidePlacas');
    cont.innerHTML = labels.map((l,i)=>{
      const v = values[i]||0, pct=((v/total)*100).toFixed(1);
      return '<div class="sv-item"><div class="sv-left"><span class="dot" style="background:'+colors[i]+'"></span>'+l+'</div><div class="sv-value">'+thousands(v)+' kg ('+pct+'%)</div></div>';
    }).join('');
  })();

  // Setores (100% abrangidos)
  (function(){
    const labels = PIE.setores_labels;
    const values = PIE.setores_values;
    const ctx = document.getElementById('pieSetores').getContext('2d');
    const {colors, total} = makePie(ctx, labels, values);
    const cont = document.getElementById('sideSetores');
    cont.innerHTML = labels.map((l,i)=>{
      const v = values[i]||0, pct=((v/total)*100).toFixed(1);
      return '<div class="sv-item"><div class="sv-left"><span class="dot" style="background:'+colors[i]+'"></span>'+l+'</div><div class="sv-value">'+thousands(v)+' ('+pct+'%)</div></div>';
    }).join('');
  })();

  // Fullscreen
  const fsBtn = document.getElementById('fsBtn');
  fsBtn.addEventListener('click', () => { if (!document.fullscreenElement) document.documentElement.requestFullscreen(); else document.exitFullscreen(); });
</script>
</body>
</html>
